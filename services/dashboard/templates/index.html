{% extends "base.html" %}

{% block title %}Home - Homelab Dashboard{% endblock %}
{% block page_title %}Welcome to Your Homelab{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card" style="background: linear-gradient(135deg, rgba(96, 165, 250, 0.1) 0%, rgba(167, 139, 250, 0.1) 100%); border: 1px solid rgba(96, 165, 250, 0.3); overflow: hidden; position: relative;">
            <div style="position: absolute; top: -50%; right: -10%; width: 300px; height: 300px; background: radial-gradient(circle, rgba(96, 165, 250, 0.1) 0%, transparent 70%); border-radius: 50%;"></div>
            <div style="position: absolute; bottom: -50%; left: -10%; width: 400px; height: 400px; background: radial-gradient(circle, rgba(167, 139, 250, 0.08) 0%, transparent 70%); border-radius: 50%;"></div>
            <div style="padding: 40px 30px; text-align: center; position: relative; z-index: 1;">
                <h1 style="font-size: 2.5rem; margin-bottom: 12px; font-weight: 700; letter-spacing: -0.02em; background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <i class="bi bi-hdd-rack" style="color: var(--accent-blue);"></i> Homelab Control Center
                </h1>
                <p style="font-size: 1.1rem; color: var(--text-secondary); margin: 0;">
                    Monitor and manage all your services from one place
                </p>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-3 mb-3">
        <div class="stat-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); padding: 20px; border-radius: 8px;">
            <i class="bi bi-box-seam" style="font-size: 1.8rem; color: var(--accent-blue); opacity: 0.8;"></i>
            <div class="stat-value" id="container-count" style="font-size: 2rem; font-weight: 600; margin: 10px 0; color: var(--text-primary);">-</div>
            <div class="stat-label" style="font-size: 0.875rem; color: var(--text-secondary);">Total Containers</div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="stat-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); padding: 20px; border-radius: 8px;">
            <i class="bi bi-play-circle-fill" style="font-size: 1.8rem; color: var(--accent-green); opacity: 0.8;"></i>
            <div class="stat-value" id="running-count" style="font-size: 2rem; font-weight: 600; margin: 10px 0; color: var(--text-primary);">-</div>
            <div class="stat-label" style="font-size: 0.875rem; color: var(--text-secondary);">Currently Running</div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="stat-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); padding: 20px; border-radius: 8px;">
            <i class="bi bi-globe" style="font-size: 1.8rem; color: var(--accent-purple); opacity: 0.8;"></i>
            <div class="stat-value" style="font-size: 2rem; font-weight: 600; margin: 10px 0; color: var(--text-primary);">3</div>
            <div class="stat-label" style="font-size: 0.875rem; color: var(--text-secondary);">Active Domains</div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="stat-card" style="background: var(--bg-secondary); border: 1px solid var(--border-color); padding: 20px; border-radius: 8px;">
            <i class="bi bi-check2-circle" style="font-size: 1.8rem; color: var(--accent-green); opacity: 0.8;"></i>
            <div class="stat-value" id="services-online" style="font-size: 2rem; font-weight: 600; margin: 10px 0; color: var(--text-primary);">6</div>
            <div class="stat-label" style="font-size: 0.875rem; color: var(--text-secondary);">Services Online</div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <i class="bi bi-activity"></i>
                Quick Actions
            </div>
            <div style="display: grid; gap: 10px;">
                <a href="/dashboard" class="btn btn-primary" style="text-decoration: none; text-align: center;">
                    <i class="bi bi-speedometer2"></i> View Dashboard
                </a>
                <a href="/containers" class="btn btn-primary" style="text-decoration: none; text-align: center;">
                    <i class="bi bi-box-seam"></i> Manage Containers
                </a>
                <a href="/system" class="btn btn-primary" style="text-decoration: none; text-align: center;">
                    <i class="bi bi-cpu"></i> System Monitor
                </a>
                <a href="/logs" class="btn btn-primary" style="text-decoration: none; text-align: center;">
                    <i class="bi bi-file-text"></i> View Logs
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <i class="bi bi-globe"></i>
                Your Services
            </div>
            <table class="table">
                <tbody>
                    <tr>
                        <td><i class="bi bi-ticket"></i> Discord Bot</td>
                        <td><a href="https://bot.rig-city.com" target="_blank" style="color: var(--accent-blue);">bot.rig-city.com</a></td>
                        <td><span class="badge badge-success" id="status-discord">●</span></td>
                    </tr>
                    <tr>
                        <td><i class="bi bi-camera-video"></i> Stream Bot</td>
                        <td><a href="https://stream.rig-city.com" target="_blank" style="color: var(--accent-blue);">stream.rig-city.com</a></td>
                        <td><span class="badge badge-warning" id="status-stream">●</span></td>
                    </tr>
                    <tr>
                        <td><i class="bi bi-film"></i> Plex Server</td>
                        <td><a href="https://plex.evindrake.net" target="_blank" style="color: var(--accent-blue);">plex.evindrake.net</a></td>
                        <td><span class="badge badge-success" id="status-plex">●</span></td>
                    </tr>
                    <tr>
                        <td><i class="bi bi-diagram-3"></i> n8n Automation</td>
                        <td><a href="https://n8n.evindrake.net" target="_blank" style="color: var(--accent-blue);">n8n.evindrake.net</a></td>
                        <td><span class="badge badge-success" id="status-n8n">●</span></td>
                    </tr>
                    <tr>
                        <td><i class="bi bi-globe"></i> Static Website</td>
                        <td><a href="https://scarletredjoker.com" target="_blank" style="color: var(--accent-blue);">scarletredjoker.com</a></td>
                        <td><span class="badge badge-success" id="status-static">●</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <i class="bi bi-info-circle"></i>
                System Information
            </div>
            <div class="row">
                <div class="col-md-4">
                    <p><strong>Hostname:</strong> <span id="hostname">Loading...</span></p>
                    <p><strong>Uptime:</strong> <span id="uptime">Loading...</span></p>
                </div>
                <div class="col-md-4">
                    <p><strong>Platform:</strong> <span id="platform">Loading...</span></p>
                    <p><strong>Architecture:</strong> <span id="arch">Loading...</span></p>
                </div>
                <div class="col-md-4">
                    <p><strong>Docker Version:</strong> <span id="docker-version">Loading...</span></p>
                    <p><strong>Last Updated:</strong> <span id="last-update">Just now</span></p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
async function loadContainers() {
    try {
        const response = await fetch('/api/containers', {
            credentials: 'include'
        });
        const result = await response.json();
        
        if (result.success && Array.isArray(result.data)) {
            const containers = result.data;
            const total = containers.length;
            const running = containers.filter(c => c.status && c.status.includes('Up')).length;
            
            document.getElementById('container-count').textContent = total;
            document.getElementById('running-count').textContent = running;
        }
    } catch (error) {
        console.error('Failed to load containers:', error);
        document.getElementById('container-count').textContent = '0';
        document.getElementById('running-count').textContent = '0';
    }
}

document.addEventListener('DOMContentLoaded', function() {
    loadContainers();
    setInterval(loadContainers, 15000);
});
</script>
{% endblock %}
