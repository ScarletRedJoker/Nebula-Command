{
  "name": "AnimateDiff Text-to-Video",
  "description": "Text-to-video generation using AnimateDiff with SD 1.5 models",
  "version": "1.0.0",
  "parameters": {
    "prompt": {
      "type": "string",
      "required": true,
      "description": "Text prompt for video generation"
    },
    "negative_prompt": {
      "type": "string",
      "default": "blurry, low quality, distorted, ugly, watermark, text",
      "description": "Negative prompt to avoid unwanted elements"
    },
    "frames": {
      "type": "integer",
      "default": 16,
      "min": 8,
      "max": 32,
      "description": "Number of frames to generate"
    },
    "fps": {
      "type": "integer",
      "default": 8,
      "min": 4,
      "max": 24,
      "description": "Frames per second in output video"
    },
    "width": {
      "type": "integer",
      "default": 512,
      "description": "Width of generated video"
    },
    "height": {
      "type": "integer",
      "default": 320,
      "description": "Height of generated video"
    },
    "steps": {
      "type": "integer",
      "default": 20,
      "min": 10,
      "max": 50,
      "description": "Number of sampling steps"
    },
    "cfg": {
      "type": "number",
      "default": 7.5,
      "min": 1.0,
      "max": 20.0,
      "description": "CFG scale for prompt adherence"
    },
    "seed": {
      "type": "integer",
      "default": -1,
      "description": "Random seed (-1 for random)"
    },
    "checkpoint": {
      "type": "string",
      "default": "dreamshaper_8.safetensors",
      "description": "SD 1.5 checkpoint model"
    },
    "motion_module": {
      "type": "string",
      "default": "mm_sd_v15_v2.ckpt",
      "description": "AnimateDiff motion module"
    }
  },
  "workflow": {
    "1": {
      "class_type": "CheckpointLoaderSimple",
      "inputs": {
        "ckpt_name": "{{checkpoint}}"
      }
    },
    "2": {
      "class_type": "ADE_AnimateDiffLoaderWithContext",
      "inputs": {
        "model": ["1", 0],
        "model_name": "{{motion_module}}",
        "beta_schedule": "sqrt_linear (AnimateDiff)",
        "context_length": 16,
        "context_stride": 1,
        "context_overlap": 4,
        "closed_loop": false
      }
    },
    "3": {
      "class_type": "CLIPTextEncode",
      "inputs": {
        "clip": ["1", 1],
        "text": "{{prompt}}"
      }
    },
    "4": {
      "class_type": "CLIPTextEncode",
      "inputs": {
        "clip": ["1", 1],
        "text": "{{negative_prompt}}"
      }
    },
    "5": {
      "class_type": "EmptyLatentImage",
      "inputs": {
        "batch_size": "{{frames}}",
        "height": "{{height}}",
        "width": "{{width}}"
      }
    },
    "6": {
      "class_type": "KSampler",
      "inputs": {
        "cfg": "{{cfg}}",
        "denoise": 1,
        "latent_image": ["5", 0],
        "model": ["2", 0],
        "negative": ["4", 0],
        "positive": ["3", 0],
        "sampler_name": "euler_ancestral",
        "scheduler": "normal",
        "seed": "{{seed}}",
        "steps": "{{steps}}"
      }
    },
    "7": {
      "class_type": "VAEDecode",
      "inputs": {
        "samples": ["6", 0],
        "vae": ["1", 2]
      }
    },
    "8": {
      "class_type": "VHS_VideoCombine",
      "inputs": {
        "images": ["7", 0],
        "frame_rate": "{{fps}}",
        "loop_count": 0,
        "filename_prefix": "AnimateDiff",
        "format": "video/h264-mp4",
        "save_output": true,
        "pingpong": false,
        "crf": 19
      }
    }
  },
  "required_nodes": [
    "CheckpointLoaderSimple",
    "ADE_AnimateDiffLoaderWithContext",
    "CLIPTextEncode",
    "EmptyLatentImage",
    "KSampler",
    "VAEDecode",
    "VHS_VideoCombine"
  ],
  "required_models": {
    "checkpoints": ["dreamshaper_8.safetensors"],
    "motion_modules": ["mm_sd_v15_v2.ckpt"]
  }
}
