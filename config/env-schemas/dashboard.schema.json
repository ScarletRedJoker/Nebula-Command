{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "nebula-command/dashboard.schema.json",
  "title": "Nebula Command Dashboard Environment Variables",
  "description": "Environment variable schema for the Next.js dashboard service",
  "type": "object",
  "properties": {
    "DATABASE_URL": {
      "type": "string",
      "description": "PostgreSQL connection string for the dashboard database",
      "required": true,
      "example": "postgresql://user:password@localhost:5432/dashboard",
      "validation": "^postgres(ql)?:\\/\\/[^:]+:[^@]+@[^:]+:\\d+\\/\\w+",
      "instructions": "Create a PostgreSQL database and user. Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE. For Replit, use the built-in PostgreSQL database which auto-populates this variable."
    },
    "SESSION_SECRET": {
      "type": "string",
      "description": "Secret key for signing session cookies and JWTs",
      "required": true,
      "minLength": 32,
      "example": "your_secure_random_session_secret_here_minimum_32_chars",
      "validation": "^.{32,}$",
      "instructions": "Generate a secure random string (minimum 32 characters). Use: openssl rand -hex 32"
    },
    "ADMIN_USERNAME": {
      "type": "string",
      "description": "Username for admin dashboard login",
      "required": true,
      "default": "admin",
      "example": "admin",
      "instructions": "Set a username for the admin login. Default is 'admin'."
    },
    "ADMIN_PASSWORD": {
      "type": "string",
      "description": "Password for admin dashboard login",
      "required": true,
      "minLength": 8,
      "example": "your_secure_password_here",
      "instructions": "Set a strong password for admin access. Use at least 8 characters with mixed case, numbers, and symbols."
    },
    "OPENAI_API_KEY": {
      "type": "string",
      "description": "OpenAI API key for AI features (Jarvis, code assist, etc.)",
      "required": false,
      "validation": "^sk-(proj-)?[a-zA-Z0-9_-]+$",
      "example": "sk-proj-your_openai_key_here",
      "instructions": "Get your API key from https://platform.openai.com/api-keys. Required for AI features. On Replit, this may be automatically provided via AI_INTEGRATIONS_OPENAI_API_KEY."
    },
    "AI_INTEGRATIONS_OPENAI_API_KEY": {
      "type": "string",
      "description": "Replit-managed OpenAI API key (auto-populated on Replit)",
      "required": false,
      "validation": "^sk-[a-zA-Z0-9_-]+$",
      "example": "sk-...",
      "instructions": "Automatically populated by Replit AI integrations. Do not set manually on Replit."
    },
    "AI_INTEGRATIONS_OPENAI_BASE_URL": {
      "type": "string",
      "description": "Replit-managed OpenAI base URL (auto-populated on Replit)",
      "required": false,
      "example": "https://ai.replit.dev/v1",
      "instructions": "Automatically populated by Replit AI integrations. Do not set manually on Replit."
    },
    "NEBULA_AGENT_TOKEN": {
      "type": "string",
      "description": "Authentication token for Windows VM Nebula Agent communication",
      "required": false,
      "minLength": 32,
      "example": "your_secure_agent_token_here",
      "validation": "^[a-zA-Z0-9_-]{32,}$",
      "instructions": "Generate a secure token: openssl rand -hex 32. Must match the token set on the Windows VM agent."
    },
    "SSH_PRIVATE_KEY": {
      "type": "string",
      "description": "PEM-format private key for SSH connections to remote servers",
      "required": false,
      "validation": "^-----BEGIN (RSA |OPENSSH )?PRIVATE KEY-----",
      "example": "-----BEGIN OPENSSH PRIVATE KEY-----\n...\n-----END OPENSSH PRIVATE KEY-----",
      "instructions": "Copy the contents of your SSH private key file (e.g., ~/.ssh/homelab). On Replit, paste the entire key including BEGIN/END markers."
    },
    "SSH_KEY_PATH": {
      "type": "string",
      "description": "Path to SSH private key file on the filesystem",
      "required": false,
      "default": "/root/.ssh/homelab",
      "example": "/root/.ssh/homelab",
      "instructions": "Path to your SSH private key. Used when SSH_PRIVATE_KEY env var is not set."
    },
    "LINODE_SSH_HOST": {
      "type": "string",
      "description": "Hostname or IP of the Linode production server",
      "required": false,
      "default": "linode.evindrake.net",
      "example": "linode.evindrake.net",
      "instructions": "Set to your Linode server's hostname or Tailscale IP."
    },
    "LINODE_SSH_USER": {
      "type": "string",
      "description": "SSH username for Linode server",
      "required": false,
      "default": "root",
      "example": "root",
      "instructions": "Username for SSH connections to Linode server."
    },
    "HOME_SSH_HOST": {
      "type": "string",
      "description": "Hostname or IP of the home Ubuntu server",
      "required": false,
      "default": "host.evindrake.net",
      "example": "host.evindrake.net",
      "instructions": "Set to your home server's hostname or Tailscale IP."
    },
    "HOME_SSH_USER": {
      "type": "string",
      "description": "SSH username for home server",
      "required": false,
      "default": "evin",
      "example": "evin",
      "instructions": "Username for SSH connections to home server."
    },
    "WINDOWS_VM_TAILSCALE_IP": {
      "type": "string",
      "description": "Tailscale IP address of the Windows VM running AI services",
      "required": false,
      "default": "100.118.44.102",
      "validation": "^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$",
      "example": "100.118.44.102",
      "instructions": "Get the Tailscale IP from the Windows VM by running: tailscale ip -4"
    },
    "WINDOWS_AGENT_URL": {
      "type": "string",
      "description": "Full URL to the Windows Nebula Agent API",
      "required": false,
      "default": "http://100.118.44.102:9765",
      "example": "http://100.118.44.102:9765",
      "instructions": "Constructed from WINDOWS_VM_TAILSCALE_IP and agent port (default 9765)."
    },
    "UBUNTU_TAILSCALE_IP": {
      "type": "string",
      "description": "Tailscale IP address of the Ubuntu home server",
      "required": false,
      "default": "100.66.61.51",
      "validation": "^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$",
      "example": "100.66.61.51",
      "instructions": "Get the Tailscale IP from Ubuntu server: tailscale ip -4"
    },
    "LINODE_TAILSCALE_IP": {
      "type": "string",
      "description": "Tailscale IP address of the Linode production server",
      "required": false,
      "default": "100.118.44.101",
      "validation": "^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$",
      "example": "100.118.44.101",
      "instructions": "Get the Tailscale IP from Linode server: tailscale ip -4"
    },
    "CLOUDFLARE_API_TOKEN": {
      "type": "string",
      "description": "Cloudflare API token for DNS management",
      "required": false,
      "validation": "^[a-zA-Z0-9_-]{40}$",
      "example": "your_cloudflare_api_token",
      "instructions": "Create token at https://dash.cloudflare.com/profile/api-tokens. Required permissions: Zone.Zone (Read), Zone.DNS (Edit), Zone.Cache Purge (Write)."
    },
    "CLOUDFLARE_ZONE_ID_EVINDRAKE": {
      "type": "string",
      "description": "Cloudflare Zone ID for evindrake.net domain",
      "required": false,
      "validation": "^[a-f0-9]{32}$",
      "example": "abc123def456...",
      "instructions": "Find Zone ID in Cloudflare dashboard > your domain > Overview (right sidebar)."
    },
    "OLLAMA_HOST": {
      "type": "string",
      "description": "URL to Ollama LLM inference server",
      "required": false,
      "default": "http://100.118.44.102:11434",
      "example": "http://100.118.44.102:11434",
      "instructions": "URL to Ollama server running on Windows VM or local machine."
    },
    "STABLE_DIFFUSION_API_URL": {
      "type": "string",
      "description": "URL to Stable Diffusion WebUI API",
      "required": false,
      "default": "http://100.118.44.102:7860/api",
      "example": "http://100.118.44.102:7860/api",
      "instructions": "URL to Stable Diffusion WebUI (Automatic1111) API endpoint."
    },
    "COMFYUI_API_URL": {
      "type": "string",
      "description": "URL to ComfyUI workflow API",
      "required": false,
      "default": "http://100.118.44.102:8188/api",
      "example": "http://100.118.44.102:8188/api",
      "instructions": "URL to ComfyUI API endpoint for advanced image workflows."
    },
    "PLEX_TOKEN": {
      "type": "string",
      "description": "Plex authentication token for media server integration",
      "required": false,
      "example": "your_plex_token",
      "instructions": "Get from Plex Web App: Sign in > View XML > find X-Plex-Token parameter. Or use: https://www.plexopedia.com/plex-media-server/general/plex-token/"
    },
    "PLEX_URL": {
      "type": "string",
      "description": "URL to Plex Media Server",
      "required": false,
      "default": "http://100.110.227.25:32400",
      "example": "http://100.110.227.25:32400",
      "instructions": "URL to your Plex server. Usually http://IP:32400."
    },
    "HOME_ASSISTANT_URL": {
      "type": "string",
      "description": "URL to Home Assistant instance",
      "required": false,
      "default": "http://100.110.227.25:8123",
      "example": "http://100.110.227.25:8123",
      "instructions": "URL to your Home Assistant instance."
    },
    "HOME_ASSISTANT_TOKEN": {
      "type": "string",
      "description": "Long-lived access token for Home Assistant API",
      "required": false,
      "example": "eyJ0eXAiOiJKV1QiLCJhbGciOi...",
      "instructions": "Generate in Home Assistant: Profile > Long-Lived Access Tokens > Create Token."
    },
    "JWT_SECRET": {
      "type": "string",
      "description": "Secret for JWT token signing (falls back to SESSION_SECRET)",
      "required": false,
      "minLength": 32,
      "example": "your_jwt_secret_key",
      "instructions": "Optional separate JWT secret. If not set, SESSION_SECRET is used."
    },
    "TERMINAL_PORT": {
      "type": "integer",
      "description": "WebSocket port for terminal server",
      "required": false,
      "default": 3001,
      "example": "3001",
      "instructions": "Port for the WebSocket terminal server."
    },
    "PORT": {
      "type": "integer",
      "description": "HTTP port for the dashboard server",
      "required": false,
      "default": 5000,
      "example": "5000",
      "instructions": "Port for the Next.js dashboard. Must be 5000 on Replit."
    },
    "NODE_ENV": {
      "type": "string",
      "description": "Node.js environment mode",
      "required": false,
      "default": "development",
      "enum": ["development", "production", "test"],
      "example": "production",
      "instructions": "Set to 'production' for production deployments."
    },
    "NEXTAUTH_URL": {
      "type": "string",
      "description": "Base URL for NextAuth.js authentication",
      "required": false,
      "example": "https://dashboard.evindrake.net",
      "instructions": "Set to the public URL of your dashboard."
    },
    "DASHBOARD_API_KEY": {
      "type": "string",
      "description": "API key for external access to dashboard APIs",
      "required": false,
      "minLength": 32,
      "example": "your_dashboard_api_key",
      "instructions": "Generate a secure API key: openssl rand -hex 32"
    },
    "SERVICE_AUTH_TOKEN": {
      "type": "string",
      "description": "Token for service-to-service authentication",
      "required": false,
      "minLength": 32,
      "example": "your_service_auth_token",
      "instructions": "Generate: openssl rand -hex 32. Used for inter-service communication."
    }
  },
  "required": ["DATABASE_URL", "SESSION_SECRET", "ADMIN_USERNAME", "ADMIN_PASSWORD"],
  "additionalProperties": true
}
